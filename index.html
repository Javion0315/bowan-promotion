<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>天天斗骰</title>
    <link rel="icon" href="./img/logo.png" type="image/x-icon" />
    <link rel="stylesheet" href="./css/bootstrap.min.css" crossorigin="anonymous">
    <link href="./css/sweetalert2.min.css" rel="stylesheet">
    <link href="./css/self.css" rel="stylesheet">
</head>
<body>
    <div class="container">
        <div class="row">
            <div class="col-md-6 offset-md-3" style="padding: 0">
                <div style="position: relative;">
                    <img src="./img/page1.png" class="img-fluid">
                    <!-- 下載按鈕 -->
                    <div style="display: flex; justify-content: space-around; position: absolute; bottom: 25px">
                        <div style="width: 35%"><a href="/app/ttds.apk" class='downloadButton'><img src="./img/android.png" class="img-fluid"></a></div>
                        <div style="width: 35%"><a href="https://web2data.me/dis_single.html?s=tgsh" class='downloadButton'><img src="./img/ios.png" class="img-fluid"></a></div>
                        <div style="width: 20%"><a href="download.html"><img src="./img/download.png" class="img-fluid"></a></div>
                    </div>
                    <!-- 優惠代碼 input  -->
                    <div class="inputText">
                        <input type="text" readonly="readonly" class="form-control inputOffer" style="background:rgba(0,0,0,0); border: 0; color: yellow; font-weight: bold;">
                    </div>
                    <!-- 註冊按鈕 -->
                    <div style="position: absolute; z-index: 5; bottom: 40%; right: 3px">
                        <div data-toggle="modal" data-target="#registerModal" style="cursor: pointer"><img src="./img/rigester.png" class="img-fluid bg1regi"></div>
                    </div>
                </div>
                <!-- 第二頁 -->
                <div style="position: relative">
                    <img src="./img/page2.png" class="img-fluid">
                    <!-- 試玩按鈕 -->
                    <div class="bgPlay" style="position: absolute; height: 40%; bottom: 0;">
                        <div><img src="./img/play.png" class="img-fluid bg2img" width="150"></div>
                    </div>
                </div>
                <!-- 固定頂部的優惠代碼提示字 -->
                <div class="opacityBg" style="position: fixed; top: 0; background: rgba(0,0,0,0.7); width: 100%; max-width: 570px;">
                    <div style="width: 15%; position: absolute; top: 10px; left: 10px"><img src="./img/pageLogo.png" class="img-fluid"></div>
                    <div class="offerText">
                        优惠代码 : <input type="text" value="" id="offer" readonly="readonly"> <a onclick="copyText()" style="color: #00A0EB; cursor: pointer;"><u>一键复制</u></a><br>
                        填入优惠代码以解锁多项优惠活动
                    </div>
                </div>
            </div>
        </div>

        <!-- 註冊 Modal -->
        <div class="modal fade" id="registerModal" tabindex="-1" role="dialog" aria-labelledby="registerModalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content" style="background-color: transparent; top: 60px">
                    <div class="modal-body" style="background-image: url('./img/modalBg.png'); background-repeat: no-repeat; width: 100%; background-size: 100%; height: 85vh;">
                        <div style="position: relative; top: 11%; width: 100%">
                            <form style="position: absolute; left: 20px; width: 92%">
                                <div class="form-group row">
                                    <div style="background-image: url('./img/pwd.png'); background-repeat: no-repeat; background-size: 48%; width: 35%; background-position: right center;"></div>
                                    <input type="password" class="form-control" style="width: 57%; margin-left: 8px">
                                </div>
                                <div class="form-group row">
                                    <div style="background-image: url('./img/confirmPwd.png'); background-repeat: no-repeat; background-size: 85%; width: 35%; background-position: right center;"></div>
                                    <input type="password" class="form-control" style="width: 57%; margin-left: 8px">
                                </div>
                                <div class="form-group row">
                                    <div style="background-image: url('./img/phone.png'); background-repeat: no-repeat; background-size: 65%; width: 35%; background-position: right center;"></div>
                                    <input type="text" class="form-control" style="width: 57%; margin-left: 8px">
                                </div>
                                <div class="form-group row">
                                    <div style="background-image: url('./img/authCode.png'); background-repeat: no-repeat; background-size: contain; width: 35%; background-position: center center;"></div>
                                    <input type="text" class="form-control" style="width: 30%; margin-left: 8px">
                                    <button style="cursor: pointer; background-color: transparent; border: none; background-image: url('./img/authBtn.png'); background-repeat: no-repeat; background-size: contain; width: 27%; background-position: center center; margin-left: 5px;"></button>
                                </div>
                                <div class="form-group row">
                                    <div style="background-image: url('./img/email.png'); background-repeat: no-repeat; background-size: 48%; width: 35%; background-position: right center;"></div>
                                    <input type="email" class="form-control" style="width: 57%; margin-left: 8px">
                                </div>
                                <div class="form-group row">
                                    <div style="background-image: url('./img/emailAuth.png'); background-repeat: no-repeat; background-size: contain; width: 35%; background-position: center 5px;"></div>
                                    <input type="text" class="form-control" style="width: 30%; margin-left: 8px">
                                    <button style="cursor: pointer; background-color: transparent; border: none; background-image: url('./img/authBtn.png'); background-repeat: no-repeat; background-size: contain; width: 27%; background-position: center center; margin-left: 5px;"></button>
                                </div>
                                <div class="form-group row">
                                    <div style="background-image: url('./img/offerCode.png'); background-repeat: no-repeat; background-size: 85%; width: 35%; background-position: right center;"></div>
                                    <input type="text" class="form-control inputOffer" style="width: 57%; margin-left: 8px" disabled>
                                </div>
                                <div class="form-group row">
                                    <button style="cursor: pointer; background-color: transparent; border: none; background-image: url('./img/confirm.png'); background-repeat: no-repeat; background-size: 35%; width: 100%; background-position: center center; height: 65px;"></button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
<script src="./js/jquery-3.4.1.min.js" crossorigin="anonymous"></script>
<script src="./js/popper.min.js" crossorigin="anonymous"></script>
<script src="./js/bootstrap.min.js" crossorigin="anonymous"></script>
<script src="./js/sweetalert2@8.js"></script>
<script>
    let domain = "api.shouhou123.com";
    let baseUrl = `https://${domain}/v1/recommender/`;
    let query = getUrlVars();
    let url = '';

    $(function() {
        url = baseUrl + 'click';

        $.ajax({
            url: url,
            type: "POST",
            data: {site: query['site'], mgm_code: query['mgm_code']},
            dataType: "json"
        });

        $('#offer').val(query['mgm_code']);
        $('.inputOffer').val(query['mgm_code']);
    });

    $(".downloadButton").click(function(){
        url = baseUrl + 'download';

        $.ajax({
            url: url,
            type: "POST",
            data: {site: query['site'], mgm_code: query['mgm_code']},
            dataType: "json"
        });
    });

    // 抓網址上的優惠代碼 query string
    function getUrlVars()
    {
        // var url = 'https://demo.com/58bowan?mgm_code=O74C6FA68';
        var url = location.href;

        if (url.indexOf('?') != -1) {
            let splitAry = url.split('?');
            let mgmCodeAry = splitAry[1].split('=');
            let siteAry = splitAry[0].split('/');

            mgmCode = mgmCodeAry[1];
            site = siteAry[siteAry.length - 2];

            return {site:site, mgm_code:mgmCode};
        }
    }
    // 複製代碼
    function copyText() {
        var copyText = document.getElementById("offer");
        copyText.select();
        copyText.setSelectionRange(0, 99999);
        document.execCommand("copy");
        Swal.fire({
            type: 'success',
            title: '已复制代码',
            text: copyText.value,
        })
    }
</script>
</html>
